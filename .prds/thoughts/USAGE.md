# Thoughts Directory Usage Guide

## Purpose

The `.prds/thoughts/` directory is a **persistent memory system** for the PRD workflow. It stores research, plans, validations, explorations, and debug sessions that survive context clearing and provide team knowledge.

## When Each Directory Is Used

### research/

**Auto-generated by**: `/code-prd` Phase 1 (Research)

**Contains**:
- Codebase analysis (relevant files and patterns)
- Architecture understanding
- Similar implementations in codebase
- Dependencies and impact analysis
- Implementation recommendations

**Read by**:
- Phase 2 (Planning) - to generate implementation plan
- Humans - for context on architectural decisions

**Example filename**: `PRD-009-context-engineering-research.md`

**Template**: `product/templates/research-template.md`

---

### plans/

**Auto-generated by**: `/code-prd` Phase 2 (Planning)

**Contains**:
- Implementation roadmap broken into sub-phases
- Specific files to modify per sub-phase
- Step-by-step implementation instructions
- Success criteria per sub-phase
- Context management strategy

**Read by**:
- Phase 3 (Implementation) - Claude executes this plan
- Humans - for understanding implementation approach

**Example filename**: `PRD-009-context-engineering-plan.md`

**Template**: `product/templates/plan-template.md`

---

### validation/

**Auto-generated by**: `/code-prd` Phase 4 (Validation)

**Contains**:
- Implementation vs plan comparison
- Implementation vs PRD comparison
- Deviations (beneficial changes + omissions)
- Issues found (critical + non-critical)
- Acceptance criteria review
- Ready/Not Ready recommendation

**Read by**:
- Humans during PR review - to verify quality
- Team leads - for post-implementation audit

**Example filename**: `PRD-009-context-engineering-validation.md`

**Template**: `product/templates/validation-template.md`

---

### explorations/

**Created by**: `/explore-prd "feature idea"`

**Contains**:
- Pre-PRD feasibility analysis
- Technical feasibility (tech stack, blockers, complexity)
- Business feasibility (strategic fit, value, risk)
- Resource feasibility (timeline, capacity, skills)
- Similar features comparison
- Decision (Create PRD / Explore More / Drop)

**Read by**:
- `/create-prd` (optional) - can reference exploration as input
- Team - for understanding why features were explored/dropped
- Product managers - for strategic planning

**Example filename**: `20250102-143022-real-time-collaboration.md`

**Template**: `product/templates/exploration-template.md`

**Use case**: "I have a vague idea - is it worth a full PRD?"

---

### debugging/

**Created by**: `/debugging "issue description"`

**Contains**:
- Bug symptom description
- Context (location, environment, timing)
- Investigation log (hypotheses tested)
- Root cause analysis
- Solution implemented (code changes)
- Verification checklist
- Prevention strategy
- Impact assessment

**Read by**:
- Team - for learning from past debugging sessions
- New developers - for understanding system quirks
- Humans - when similar bugs occur (searchable history)

**Example filename**: `20250102-oauth-redirect-fails-production.md`

**Template**: `product/templates/debug-template.md`

**Use case**: "Bug found - need structured investigation and team knowledge capture"

---

## Workflow Integration

### Standard PRD Workflow (v0.4.0+)

```bash
# Step 1: Create PRD
/create-prd "Feature name"
# → Creates product/prds/01-draft/PRD-XXX.md

# Step 2: Review PRD
/review-prd PRD-XXX
# → Reviews and grades PRD

# Step 3: Setup for Development
/setup-prd PRD-XXX
# → Moves to 02-ready/, creates branch

# Step 4: Implement with 4-Phase Workflow
/code-prd PRD-XXX
# → Phase 1: Research → saves to thoughts/research/PRD-XXX-research.md
# → Phase 2: Plan    → saves to thoughts/plans/PRD-XXX-plan.md
# → Phase 3: Implement (using plan)
# → Phase 4: Validate → saves to thoughts/validation/PRD-XXX-validation.md

# Step 5: Create PR
# PR description can reference validation report

# Step 6: Complete PRD
/complete-prd PRD-XXX
# → Moves to 04-complete/
```

### Pre-PRD Exploration Workflow

```bash
# Quick feasibility check before committing to full PRD
/explore-prd "Feature idea description"
# → Generates thoughts/explorations/YYYYMMDD-HHMMSS-feature-slug.md
# → Decision: Create PRD / Explore More / Drop

# If "Create PRD" decision:
/create-prd @thoughts/explorations/20250102-feature-idea.md
# → PRD pre-populated with exploration findings
```

### Debugging Workflow

```bash
# During any development work, when bug found:
/debugging "Bug description"
# → Structured investigation
# → Saves to thoughts/debugging/YYYYMMDD-bug-slug.md
# → Can link to related PRD

# Team can search debug logs later:
grep -r "OAuth" .prds/thoughts/debugging/
# → Find similar past bugs and solutions
```

---

## Context Engineering Benefits

### 1. Context Clearing Without Memory Loss

**Problem**: Claude Code context can reach 90%+ during implementation, degrading output quality.

**Solution**:
- Phase 1 (Research) → Context cleared, but research saved to `thoughts/research/`
- Phase 2 (Plan) → Context cleared, but plan saved to `thoughts/plans/`
- Phase 3 (Implementation) → Loads plan only (not full PRD) to save context
- Phase 4 (Validation) → References plan + PRD for comparison

**Result**: Context stays < 60% throughout workflow, maintaining high-quality AI outputs.

---

### 2. Team Knowledge Base

**Problem**: Debugging sessions and exploration decisions are lost after context clears.

**Solution**: All insights persist in `thoughts/` directory:
- Searchable history of past bugs and solutions
- Record of explored but dropped features (with rationale)
- Research findings from past PRD implementations
- Architectural decisions and their justifications

**Result**: New team members can learn from past work, similar bugs are solved faster.

---

### 3. Implementation Quality

**Problem**: Implementation can drift from PRD intent without validation.

**Solution**:
- Research phase identifies constraints early
- Plan provides clear roadmap
- Validation phase catches deviations before PR

**Result**: Higher implementation quality, fewer post-merge bugs.

---

## Searching Thoughts

### Find all research for a specific PRD:
```bash
ls -l .prds/thoughts/research/PRD-009*
```

### Search all thoughts for a keyword:
```bash
grep -r "authentication" .prds/thoughts/
```

### Find recent explorations:
```bash
ls -lt .prds/thoughts/explorations/ | head -5
```

### Find all debugging sessions:
```bash
ls -l .prds/thoughts/debugging/
```

---

## Cleanup Strategy

### Automatic Cleanup: None
Thoughts are permanent knowledge - they should **not** be auto-deleted.

### Manual Cleanup Options:

**Option A**: Archive with PRD completion
```bash
# When /complete-prd PRD-XXX runs:
# 1. Keep validation report in thoughts/
# 2. Archive research + plan to .prds/archive/PRD-XXX/
# Exploration and debugging remain searchable
```

**Option B**: Annual cleanup
```bash
# Once per year, archive old thoughts:
tar -czf thoughts-archive-2024.tar.gz .prds/thoughts/
# Keep explorations and debugging (valuable long-term)
# Delete research/plans older than 1 year
```

**Recommendation**: Option A - archive with PRD completion, but keep explorations + debugging indefinitely.

---

## Git Strategy

### Recommendation: Commit to Git

**Why commit?**
- Team collaboration - everyone sees research/plans/validations
- Historical record - understand past decisions
- Onboarding - new team members learn from past work
- Code review - validation reports inform PR reviews

**Why NOT commit?**
- Privacy - if research contains sensitive info
- Noise - lots of files generated

**Decision**: ✅ **Commit to Git** for team benefit

Add to `.gitignore` only if:
```gitignore
# Ignore if working solo
.prds/thoughts/research/
.prds/thoughts/plans/

# Never ignore these (valuable team knowledge)
# .prds/thoughts/explorations/
# .prds/thoughts/debugging/
# .prds/thoughts/validation/
```

---

## Directory Structure Reference

```
.prds/thoughts/
├── README.md                    # Directory overview
├── USAGE.md                     # This file
├── research/                    # Phase 1 outputs
│   ├── PRD-001-research.md
│   ├── PRD-002-research.md
│   └── ...
├── plans/                       # Phase 2 outputs
│   ├── PRD-001-plan.md
│   ├── PRD-002-plan.md
│   └── ...
├── validation/                  # Phase 4 outputs
│   ├── PRD-001-validation.md
│   ├── PRD-002-validation.md
│   └── ...
├── explorations/                # /explore-prd outputs
│   ├── 20250101-120000-feature-a.md
│   ├── 20250102-143000-feature-b.md
│   └── ...
└── debugging/                   # /debugging outputs
    ├── 20250101-oauth-bug.md
    ├── 20250102-payment-issue.md
    └── ...
```

---

## Related

- **PRD-009**: Context Engineering Workflow (introduced this system)
- **Config**: `.claude/config.json` has `context_engineering` section
- **Templates**: `product/templates/*.md` for document structure

---

**Version**: 1.0.0
**Last Updated**: 2025-01-02
**Plugin Version**: v0.4.0
